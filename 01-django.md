# Djangoとは

- [Djangoとは](#djangoとは)
  - [HTML、CSSおよびJavaScriptとは](#htmlcssおよびjavascriptとは)
  - [Djangoのプロジェクトとアプリ](#djangoのプロジェクトとアプリ)
    - [Djangoのプロジェクトとは](#djangoのプロジェクトとは)
    - [Djangoのアプリとは](#djangoのアプリとは)
  - [本チュートリアルで提示するソースコードについて](#本チュートリアルで提示するソースコードについて)
  - [本チュートリアルのソースコード](#本チュートリアルのソースコード)
  - [本チュートリアルの前提事項](#本チュートリアルの前提事項)
    - [OS](#os)
    - [Visual Studio Code](#visual-studio-code)
  - [まとめ](#まとめ)

[Django](https://www.djangoproject.com/)は、PythonでWebアプリケーションを開発するときに利用される、Webアプリケーション開発フレームワークの1つです。
Djangoはフルスタックで、Webアプリケーションの開発に必要な、ほとんどの機能を提供しています。

Djangoを利用することで、例えばサイボウズなどログインしたユーザーに合わせたWebページを動的に生成して配信するWebアプリケーションを開発できます。

> フレームワークとは「枠組み」を意味します。
> 開発者が、Webアプリケーション開発フレームワークが定めた「枠組み」に従うことで、Webアプリケーションを容易に開発できるようになります。

Djangoは、主に以下の機能を開発者に提供します。

- MVCモデルサポート
  - Model-View-Controller（MVC）アーキテクチャにより、モデル、ビュー及びコントローラにコンポーネントを分割して開発します。
    - モデルは、アプリケーションで扱われるデータで、ビジネスロジックを表現します。
    - ビューは、モデルをユーザーに提示するために、モデルをHTMLなどに変換します。
    - コントローラーは、ユーザーからの入力をアプリケーションに反映するために、ビューとモデルを橋渡しします。
  - ただし、Djangoは、MVCではなくModel-View-Template (MVT)と表現しています。
    - モデルの役目はMVCと同様です。
    - ビューは、ユーザーからの入力を処理する役目を担います（MVCのコントローラーに近い）。
    - テンプレートは、HTMLなどのテキストの雛形を定義したもので、ビューがレンプレートをレンダリングすることでHTMLなどを生成します。
- データベースサポート
  - Djangoは、`PostgreSQL`、`MySQL`及び`SQL Server`など、複数のデータベースをサポートしています。
  - Djangoは、モデルとテーブル、モデルインスタンスとレコード、モデルフィールドとカラムを紐付けします。
  - モデルを定義すると、マイグレーションと呼ばれる機能により、モデルを表現するテーブルがデータベースに作成されます。
    モデルに定義したモデルフィールドは、そのテーブルのカラムに対応します。
    モデルを変更した後にマイグレーションすることで変更がテーブルに反映され、またモデルを削除するとテーブルが削除されます。
- デバッグ環境
  - Djangoが提供する開発用サーバーで開発中のWebアプリケーションを動作させることで、容易にデバッグできます。
  - また、例外が発生した場合、Webページにその例外の情報を提示します。
- ORM (Object-Relational Mapping)
  - データベースを操作するSQLを使用することなく、モデルやモデルインスタンスを操作することで、データベースのレコードを検索、参照、登録、更新及び削除などできます。
    - モデルとモデルインスタンスは、概念と実態に対応しています。
      `書籍`という概念が実体化して`Fluent Python`など現実の書籍（実態）になります。
- ルーティング
  - リクエストされたURL（`リクエストURL`）により、そのリクエストを処理するビューを決定します。
    Djangoではこれを`ディスパッチ`と呼んでいます。
- フォーム処理
  - フォームは、Webページでユーザーがデータを入力するHTMLの要素です。
  - フォームに入力されたデータは、Webアプリケーションに送信されます。
  - Djangoは、フォームの作成及びフォームに入力されたデータの取得と検証などを自動化します。
- ユーザー管理、認証及び認可
  - ユーザーの登録、更新及び削除する機能や、ユーザーを認証及び認可する機能を提供しています。
  - ユーザーをモデルとして提供していますが、独自にユーザーのモデルを定義できます。
- 管理サイト
  - モデルインスタンスを参照、登録、更新及び削除するなど、モデルインスタンスを管理するWebサイトを提供します。
- セキュア（安全性）
  - セキュリティに配慮したフレームワークで、クロスサイトリクエストフォージェリ（CSRF）、SQLインジェクション、XSS（クロスサイトスクリプティング）などの攻撃から保護または回避する機能を提供します。
  - 脆弱性が発見または報告されたとき、即座にそれらを修正するパッチを提供しています。
- 地理空間情報
  - 地理空間情報を管理する[GeoDjango](https://docs.djangoproject.com/en/4.2/ref/contrib/gis/)を提供します。
- Pythonエコシステム
  - [PyPI (Python Package Index)](https://pypi.org/)が提供する多種多様で膨大なパッケージを利用できます。
- 単体テスト及び統合テスト

![Djangoダイアグラム](./images/request_handle_diagram.png)

## HTML、CSSおよびJavaScriptとは

`HTML`は、ドキュメントを記述するための`マークアップ`言語です。
ここで、マークアップとは、文章などに対して、章や段落などに`意味付け`することです。

`CSS`とは、HTMLに記述された文章などに対して、赤色で文字を表示するなど装飾するための言語です。

`JavaScript`とは、主にブラウザで動作するプログララミング言語で、Webページの内容を変更するときなどに利用します。

通常、WebページはHTML、CSS、JavaScript及び画像などその他のリソースで構成されます。

## Djangoのプロジェクトとアプリ

### Djangoのプロジェクトとは

Djangoのプロジェクトは、すべてのDjangoのアプリを管理するもので、Webアプリケーション全体に対応します。
プロジェクトは、設定情報や、CSS、JavaScript、画像などブラウザに送信する静的なファイルなど、プロジェクト全体で扱うコンテンツを管理します。

### Djangoのアプリとは

Djangoのアプリは、Webアプリケーションが提供する機能の一部を再利用可能な形でまとめたものです。
プロジェクトは1つ以上のアプリで構成され、例えば、ショッピングサイトのプロジェクトを以下の複数のアプリで構成することが考えられます。

```text
ショッピングサイトプロジェクト
├── 顧客管理アプリ
├── 顧客認証アプリ
├── 商品管理アプリ
├── 在庫管理アプリ
├── 注文管理アプリ
├── 入金管理アプリ
└── 配送管理アプリ
```

> Djangoのアプリは、一般的なアプリケーション（アプリ）とは概念が異なります。

## 本チュートリアルで提示するソースコードについて

本チュートリアルでは2つの方法でソースコードを提示します。

1つめは、既存のソースコードを変更せずに、提示したコードでソースコードをすべて入れ替えるか、提示したコードを単にソースコードに追加する方法です。
これらは、提示したソースコードのすべての行について、先頭に`+`や`-`がないソースコードです。
次に例を示します。

```python
def fibonacci(n: int) -> int:
    if n <= 1:
        return n
    return (fibonacci(n - 1) + fibonacci(n - 2))
```

2つめは、既存のソースコードの実装を変更する方法です。
提示したコードの先頭に`-`と1つのスペースがついている行は、既存のソースコードから削除する行です。
逆に、先頭に`+`と1つのスペースがついている行は、既存のソースコードに追加する行です。
また、先頭に`+`や`-`がついていない行は、既存のソースコードを変更しない行です。
なお、このソースコードの提示方法は、ソースコードの一部が明示的または暗黙的に省略されています。

```python
  def fibonacci(n: int) -> int:
      if n <= 1:
          return n
-     return (fibonacci(n - 1) + fibonacci(n - 2))
+     return fibonacci(n - 1) + fibonacci(n - 2)
```

上記コードは、現在の`fibonacci`関数の`return`文（行の先頭が`-`）を削除して、新たに行の先頭が`+`の`return`文を追加します。
ただし、`+`とその後の`スペース1つ`は削除してください。

## 本チュートリアルのソースコード

本チュートリアルのソースコードは[GitHubのリポジトリ](https://github.com/xjr1300/book_management)にあります。
チュートリアルのドキュメント中に、ソースコードなどの変更を確定したコミットのコミットIDと、そのコミットに付けたタグを示してあります。
このコミットIDとタグをリポジトリで参照して、コミット時点のソースコードなどの状態や、前のコミットからのソースコードの差分を確認できます。

## 本チュートリアルの前提事項

### OS

本チュートリアルは、`Ubuntu`を実行環境として想定しています。
本チュートリアルを`Windows`などの他の環境で実行する場合は、本チュートリアルで使用するコマンドを`Windows`のコマンドに置き換えてください。

```bash
# UbuntuでPython仮想環境を有効にする。
source venv/bin/activate
# WindowsでPython仮想環境を有効にする。
venv\Scripts\activate.bat
```

### Visual Studio Code

本チュートリアルは、`Visual Studio Code (vscode)`で実装することを想定しています。
また、`vscode`には、次のエクステンションをインストールしてください。

- Python extension for Visual Studio Code (マイクロソフト社)
- Pylance （マイクロソフト社）
- VS Code Makefile Tools （マイクロソフト社）

## まとめ

本章では、Djangoの概要について説明しました。

次の章では、Djangoのプロジェクトを作成して、開発環境を整備します。
